{"version":3,"file":"ngx-xml-to-json.js","sources":["ng://ngx-xml-to-json/lib/ngx-xml-to-json.service.ts","ng://ngx-xml-to-json/lib/ngx-xml-to-json.component.ts","ng://ngx-xml-to-json/lib/ngx-xml-to-json.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class NgxXmlToJsonService {\n  private parser: any;\n  private mimeType:any = 'text/xml';\n  constructor() { \n    this.parser = new DOMParser();\n  }\n\n  xmlToJson(xmlString: string, myOptions: any) {\n    let jsonObj = Object.create(null);\n    let obj = {};\n    const options = { // set up the default options \n      mergeCDATA: false, // extract cdata and merge with text\n      cDataKey:'cData',\n      textKey: 'text', // tag name for text nodes\n      valueKey: 'value', // tag name for attribute values\n      attrKey: 'attr', // tag for attr groups\n      cdataKey: 'cdata', // tag for cdata nodes (ignored if mergeCDATA is true)\n    };\n    // update the options\n    for(let prop in myOptions ) {\n      if(options[prop] !== undefined) {\n        options[prop] = myOptions[prop];\n      }\n    }\n    let xmlDoc = this.parser.parseFromString(xmlString, this.mimeType);\n    obj = this.convertToJson(xmlDoc, options);\n    return Object.assign(jsonObj, obj);\n  }\n\n  private convertToJson(doc, opt){\n    let obj = {};\n    switch(doc.nodeType) {\n      case 1 : // ELEMENT_NODE\n        const eleAttr = doc.attributes;\n        if (eleAttr.length > 0) {\n          obj[opt.attrKey] = {};\n          for( let i= 0 ; i< eleAttr.length; i++ ) {\n            const attribute = eleAttr[i];\n            obj[opt.attrKey][attribute.nodeName] = attribute['nodeValue'];\n          }\n        }\n        break;\n      case 3 : // TEXT_NODE\n        obj = doc.nodeValue;\n        break;\n      case 4 : // CDATA_SECTION_NODE\n        obj = doc.nodeValue;\n        break;\n      case 7 : // PROCESSING_INSTRUCTION_NODE\n        obj = doc.nodeValue;\n        break;\n      default:\n        \n    }\n    \n    if( doc.hasChildNodes()){\n      if(doc.childNodes.length === 1 && doc.childNodes[0]['nodeType'] === 3){\n        obj[opt.textKey] = doc.childNodes[0]['nodeValue'];\n      } else {\n        doc.childNodes.forEach(node => {\n          let cData: any;\n          let nodeName = node.nodeType === 3 ? opt.textKey : node.nodeName;\n          if(obj[nodeName] === undefined) {\n            if( node.nodeType === 4 ){\n              cData = this.convertToJson(node,opt);\n              if(!opt.mergeCDATA){\n                obj[opt.cDataKey] = cData;\n              }\n            } else {\n              obj[nodeName] = cData === undefined ? this.convertToJson(node,opt) : `${cData}${this.convertToJson(node,opt)}`;\n            }\n          } else {\n            const previousNode = obj[nodeName];\n            obj[nodeName] = [];\n            obj[nodeName].push(previousNode);\n            obj[nodeName].push(this.convertToJson(node, opt));\n          }\n        });\n      }\n    }\n    return obj;\n  }\n\n}\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'ngx-ngx-xml-to-json',\n  template: `\n    <p>\n      ngx-xml-to-json works!\n    </p>\n  `,\n  styles: []\n})\nexport class NgxXmlToJsonComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { NgxXmlToJsonComponent } from './ngx-xml-to-json.component';\n\n@NgModule({\n  declarations: [NgxXmlToJsonComponent],\n  imports: [\n  ],\n  exports: [NgxXmlToJsonComponent]\n})\nexport class NgxXmlToJsonModule { }\n"],"names":[],"mappings":";;;;;;AAAA,MAKa,mBAAmB;IAG9B;QADQ,aAAQ,GAAO,UAAU,CAAC;QAEhC,IAAI,CAAC,MAAM,GAAG,IAAI,SAAS,EAAE,CAAC;KAC/B;;;;;;IAED,SAAS,CAAC,SAAiB,EAAE,SAAc;;YACrC,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC;;YAC7B,GAAG,GAAG,EAAE;;cACN,OAAO,GAAG;;YACd,UAAU,EAAE,KAAK;;YACjB,QAAQ,EAAC,OAAO;YAChB,OAAO,EAAE,MAAM;;YACf,QAAQ,EAAE,OAAO;;YACjB,OAAO,EAAE,MAAM;;YACf,QAAQ,EAAE,OAAO;SAClB;;QAED,KAAI,IAAI,IAAI,IAAI,SAAS,EAAG;YAC1B,IAAG,OAAO,CAAC,IAAI,CAAC,KAAK,SAAS,EAAE;gBAC9B,OAAO,CAAC,IAAI,CAAC,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC;aACjC;SACF;;YACG,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,SAAS,EAAE,IAAI,CAAC,QAAQ,CAAC;QAClE,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;QAC1C,OAAO,MAAM,CAAC,MAAM,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;KACpC;;;;;;;IAEO,aAAa,CAAC,GAAG,EAAE,GAAG;;YACxB,GAAG,GAAG,EAAE;QACZ,QAAO,GAAG,CAAC,QAAQ;YACjB,KAAK,CAAC;;;sBACE,OAAO,GAAG,GAAG,CAAC,UAAU;gBAC9B,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;oBACtB,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC;oBACtB,KAAK,IAAI,CAAC,GAAE,CAAC,EAAG,CAAC,GAAE,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAG;;8BACjC,SAAS,GAAG,OAAO,CAAC,CAAC,CAAC;wBAC5B,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,QAAQ,CAAC,GAAG,SAAS,CAAC,WAAW,CAAC,CAAC;qBAC/D;iBACF;gBACD,MAAM;YACR,KAAK,CAAC;gBACJ,GAAG,GAAG,GAAG,CAAC,SAAS,CAAC;gBACpB,MAAM;YACR,KAAK,CAAC;gBACJ,GAAG,GAAG,GAAG,CAAC,SAAS,CAAC;gBACpB,MAAM;YACR,KAAK,CAAC;gBACJ,GAAG,GAAG,GAAG,CAAC,SAAS,CAAC;gBACpB,MAAM;YACR,QAAQ;SAET;QAED,IAAI,GAAG,CAAC,aAAa,EAAE,EAAC;YACtB,IAAG,GAAG,CAAC,UAAU,CAAC,MAAM,KAAK,CAAC,IAAI,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,EAAC;gBACpE,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;aACnD;iBAAM;gBACL,GAAG,CAAC,UAAU,CAAC,OAAO;;;;gBAAC,IAAI;;wBACrB,KAAU;;wBACV,QAAQ,GAAG,IAAI,CAAC,QAAQ,KAAK,CAAC,GAAG,GAAG,CAAC,OAAO,GAAG,IAAI,CAAC,QAAQ;oBAChE,IAAG,GAAG,CAAC,QAAQ,CAAC,KAAK,SAAS,EAAE;wBAC9B,IAAI,IAAI,CAAC,QAAQ,KAAK,CAAC,EAAE;4BACvB,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,EAAC,GAAG,CAAC,CAAC;4BACrC,IAAG,CAAC,GAAG,CAAC,UAAU,EAAC;gCACjB,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,KAAK,CAAC;6BAC3B;yBACF;6BAAM;4BACL,GAAG,CAAC,QAAQ,CAAC,GAAG,KAAK,KAAK,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,EAAC,GAAG,CAAC,GAAG,GAAG,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,EAAC,GAAG,CAAC,EAAE,CAAC;yBAChH;qBACF;yBAAM;;8BACC,YAAY,GAAG,GAAG,CAAC,QAAQ,CAAC;wBAClC,GAAG,CAAC,QAAQ,CAAC,GAAG,EAAE,CAAC;wBACnB,GAAG,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;wBACjC,GAAG,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,CAAC;qBACnD;iBACF,EAAC,CAAC;aACJ;SACF;QACD,OAAO,GAAG,CAAC;KACZ;;;YApFF,UAAU,SAAC;gBACV,UAAU,EAAE,MAAM;aACnB;;;;;;;;;;ACJD,MAWa,qBAAqB;IAEhC,iBAAiB;;;;IAEjB,QAAQ;KACP;;;YAdF,SAAS,SAAC;gBACT,QAAQ,EAAE,qBAAqB;gBAC/B,QAAQ,EAAE;;;;GAIT;aAEF;;;;;;;;;ACVD,MASa,kBAAkB;;;YAN9B,QAAQ,SAAC;gBACR,YAAY,EAAE,CAAC,qBAAqB,CAAC;gBACrC,OAAO,EAAE,EACR;gBACD,OAAO,EAAE,CAAC,qBAAqB,CAAC;aACjC;;;;;"}